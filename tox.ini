[tox]
envlist = py312-ha

[testenv]
skip_install = true
passenv = HOME,CI,GITHUB_*,PYTEST_*,PIP_INDEX_URL,PIP_EXTRA_INDEX_URL
setenv =
    PYTHONWARNINGS=default

[testenv:py312-ha]
basepython = python3.12
setenv =
    {[testenv]setenv}
    PIP_ONLY_BINARY=PyYAML
deps =
    pytest==8.2.2
    pytest-asyncio==0.24.0
    pytest-homeassistant-custom-component
    PyYAML==6.0.2
    homeassistant
commands =
    pytest -q

# Keep a compatibility env so CI jobs referencing py313-ha continue to work,
# but run them on Python 3.12 to avoid astral build issues on 3.13.
[testenv:py313-ha]
basepython = python3.12
setenv =
    {[testenv]setenv}
    PIP_ONLY_BINARY=PyYAML
deps = {[testenv:py312-ha]deps}
commands = {[testenv:py312-ha]commands}